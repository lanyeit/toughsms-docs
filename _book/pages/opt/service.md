# 业务概念

## 组织结构

组织结构是整个系统业务运营的基础，一个良好的组织结构设计能有效的适应运营商的业务规划发展。

- 组织：具有独立的运营管理要求，比如一个独立的公司，以及他下属的独立运营的子（分）公司，业务部门，所属代理商等，同级组织之间业务数据彼此独立，不可互访，上级组织可以访问下级组织数据。
- 区域，归属于组织的一个分类，区域不具备独立运营特质，没有多层结构。
- 组织区域关系：组织可以支持多层结构，理论上可以无限层级，无论哪个层级的组织都可以创建自己的区域。
- 操作员组（或权限组/角色）：系统的授权模式，操作员组不属于单个组织，全局定义，各个组织共享操作员组数据，通过对系统各项权限的分组来定义所属操作员可访问的系统资源和功能。
- 操作员：操作员归属于组织，和操作员组绑定，每个操作员可以绑定多个权限组，通过操作员组的绑定来获得系统操作权限。同时操作员可以被授权多个区域，操作员只能操作授权区域的数据。

![](http://static.toughcloud.net/toughsms/tc_20180524165643_9.png)

如图所示，系统支持多级组织结构，在实际运营中，针对自身的运营模式去规划组织结构，有些组织本身并不去做具体的业务运营，而是由下属组织去运营，这种情况下，就创建所需要的下级组织节点，不做业务实际运营的组织节点，通常也不需要管理直属区域，资费，操作员等。而需要进行实际业务运营的组织节点，则需要规划本节点的区域，资费，操作员等。

## 资费结构

- 服务定义：服务是资费（或商品）定义的基础，每个服务定义了一系列业务策略，比如一个10M宽带服务，定义了用户认证授权的上行速率，下行速率，最大在线数等业务策略，服务属于系统全局，有最高层管理员设定；服务不能直接作为商品销售，必须通过定价打包为商品才能销售。
- 商品（或资费）：基于服务定价的可销售的商品，商品归属于组织，每个运营组织可以定义自己专有的销售商品。
    - 一般时段计费：采用计时方式，时间过期后用户停止计费，在创建方式上，可支持以小时，天，月，年为单位来灵活的定价。
    - 自然月计费：按固定的自然月计费，到期时间总是月末，当月订购下月生效，对于流量计费模式，月末流量清零。
    - 流量时段混合计费模式：在预设的时间内，分配固定的流量，流量用完或时间结束后用户停止认证。


![1526282259679](http://static.toughcloud.net/toughsms/tc_20180517161152_6.png)

如图所示，服务不属于任何组织节点，但被所有组织节点共享，每个组织基于自己的运营需求对服务定价形成可销售的商品资费。

## 资源管理

- 终端设备：当客户开通服务时，运营组织给用户分配的终端设备，比如给宽带用户分配的拨号终端，给IPTV用户分配的机顶盒等，终端设备可以是购买，也可以是租用，对于租用的设备，客户开户时收取的是押金，用户结束使用服务时可以申请退还。

- BRAS接入设备：接入设备主要是指充当PPPoE，PPTP，L2TP 接入服务器的路由器等设备，系统支持多设备接入管理，接入设备信息必须在系统中登记才能和计费系统进行通信。

  系统支持标准的Radius协议接入，通常大多数路由器接入设备可以以标准类型配置。但是对于很多厂家的接入设备，在标准协议下并不能工作的很完美，比如MAC地址，VLAN往往以各自的私有协议封装，计费系统为了准确的处理这些信息，必须对这些接入设备进行类型标识，并在消息处理时进行适配处理。


## 业务定义

- 客户：主要是指购买商品使用服务的用户。
- 账号：客户使用服务的业务号码，一个客户可以拥有多个账号。
- 收费项目：在标准的商品费用之外的收费类别，比如安装调试费，服务迁移费等，这些费用项目一般预先就定义好，在业务受理时，除了收取商品费用，可以同时收取其他费用，但费用收取金额不可改变。每个运营组织有自己专有的收费项目。
- 工单：用来辅助业务受理的待办事件跟踪，每个工单记录了需要进一步处理的工作，比如用户安装调试，用户故障处理，用户投诉处理等，每个工单有一个完整的周期，从开始创建到进入处理到处理完成或取消，都可以进行详细的记录描述，跟踪变化，直到解决。

## 业务受理

- 开户（用户报装）：用户登记开通业务账号的过程，通常需要登记用户基本资料，并订购一项或多项商品资费，在系统中创建用户的完整信息，让用户具备使用服务的能力；开户时需要收取用户费用以及记录工单。
- 资费变更：用户在使用服务器间，申请改变当前订购商品资费的过程，变更完成后，用户使用的服务相应改变，比如从10M的商品变更到20M，用户的上网速率会由10M更新到20M，同时变更套餐可能涉及到需要缴费或退费的方式来补差价；资费变更后用户账号立即生效。
- **账号续费**：用户在使用服务器间，或者服务已到期，申请继续使用服务的过程，用户续费可以订购相同套餐或不同的套餐，如果用户续订相同资费，则用户到期时间会延长，但相关的服务策略（比如上网速率）不会变，如果用户已经到期，且续订不同资费，则用户到期时间相应延长，并且服务策略会更新。如果用户未到期且订购不同的商品资费，则当前账号到期时间和服务策略不变化，但会保存一条预订商品记录，等当前账号到期时，自动实现续订，延长到期时间以及更新服务策略。
- **账号停机**：用户在使用服务期间申请暂停服务的过程，停机后，用户状态变更为暂停，拨号认证将无法通过。
- **账号复机**：对停机账号恢复正常使用的过程，复机时，系统会自动计算用户剩余时间，自动顺延，复机时，可以选择收取费用，如果系统定义了相关的收费项目。
- 用户移机：用户在使用服务的过程中，涉及到地理位置迁移，可能需要处理线路改动，重新调试的过程，大部分工作可能由服务人员在系统外完成，系统根据实际需要记录工单，收取费用。
- 缴费与退费：当涉及到一些商品和收费项目之外的费用处理时，可以直接进行人工缴费或退费的方式来处理。
- 销户：用户申请终止当前使用服务，并退还剩余费用的过程，如果用户还有未完成的工单，需要先完成后才能销户，销户后，用户账号被停止使用，无法通过认证。

## 帐务

交易记录：用户订购续订，变更，复机，销户等业务受理产生的原始费用记录，每条交易记录包含了所有的费用明细，如商品订购费用，收费项目费用。

交易对账：财务人员对交易记录审核确认的过程，每笔交易只能对账一次，对账确认后，交易数据不允许再改动。

交易差错处理：当遇到业务受理出错导致录入的交易数据与实际不符时，需要在对账时进行差错处理，将费用调整到和实际一致，产生的费用差额系统记录为一笔调帐记录，交易差错处理必须在对账之前完成。
